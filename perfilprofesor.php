<?php
 session_start();
 $pagina="profesor";
 include ('config.php');
 include("validacion_sesion.php");
$sql = "SELECT * FROM usuarios WHERE id='$_SESSION[Id]' ";
$result = $conn->query($sql); 
if ($result->num_rows > 0) {
	$row = $result->fetch_assoc();
	}
if (isset ($_POST['modificar'])){
  $nombre=$_POST['nombre'];
  $apellido=$_POST['apellido'];
	$clave=$_POST['clave'];
	$correo=$_POST['correo'];
	$telefono=$_POST['telefono'];
	$fechanac=$_POST['fechadenac'];

  include('Subir_imagen.php');

$sql = "UPDATE usuarios SET foto='$nombre_archivo' ,clave='$clave',correo='$correo',telefono='$telefono',nombre='$nombre',apellido='$apellido',`fecha de nacimiento`='$fechanac' WHERE id='$_SESSION[Id]'";

if ($conn->query($sql) === TRUE) {
    echo "  <div id='modal1' class='modal open' tabindex='0' style='z-index: 1003; display: block; opacity: 1; top: 10%; transform: scaleX(1) scaleY(1);'>
              <div class='modal-content center'>
                <h4 class='incorrecto'>Datos actualizados</h4>
                <a href='' class='waves-effect waves-light btn-large shake-slow btninicio modal-close'>Continuar</a>
              </div>
            </div>
            <div class='modal-overlay' style='z-index: 1002; display: block; opacity: 0.5;'></div>";
  
  } else {
      echo "  <div id='modal1' class='modal open' tabindex='0' style='z-index: 1003; display: block; opacity: 1; top: 10%; transform: scaleX(1) scaleY(1);'>
      <div class='modal-content center'>
        <h4 class='incorrecto'>Error al actualizar los datos</h4>
        <a href='' class='waves-effect waves-light btn-large shake-slow btninicio modal-close'>Reintentar</a>
      </div>
    </div>
    <div class='modal-overlay' style='z-index: 1002; display: block; opacity: 0.5;'></div>" . $conn->error;
  }	
} 

?>
<!doctype html>
<html>
<head>
    <?php
        include ('head.php');
    ?>
<title>Plataforma Virtual Sysdatec</title>
</head>
<body >
  <?php
      include ('header.php');
  ?>
  <div class="container registro">
    <a href="InicioProfesor.php"><i class="material-icons">keyboard_return</i></a>
  </div>
  <form method="post" action="" enctype="multipart/form-data">  
	<div class="container">
    <div class="row">
    <h2 class="cuenta_titulo">Mi Perfil</h2>
    <form class="col s12" method="post" action="">
      <div class="row">
		  <div class="col s5 contenedor_perfil">
        <div class="col l4 foto_perfil">
        <img src="Imagenes perfil/<?php echo $row["foto"]?>" class="responsive-img" width="auto">
        <div class="file-field input-field">
          <div class="btnfoto">
            <i class="material-icons">create</i>
              <input type="file" name="imagen" size="20">
            </div>
          </div>  
      </div>
        <div class="col l7 right nombre">
          <h2 class="nombre_perfil"> <?php echo $nombre_usuario ?></h2>
          <div class="tipo_perfil">
          <svg xmlns="http://www.w3.org/2000/svg" width="27" height="30" viewBox="0 0 164 173" fill="none"><path d="M3.20312 3.20312H160.797V111.251H3.20312V3.20312Z" fill="#26A69A"></path><path d="M157.594 6.40625V108.048H6.40625V6.40625H157.594ZM164 0H0V114.454H164V0Z" fill="#5D4037"></path><path d="M10.25 151.226V164H121.898V151.226C121.898 131.789 94.4922 121.924 66.4969 121.962C38.6809 121.988 10.25 130.636 10.25 151.226Z" fill="#546E7A"></path><path d="M57.3872 134.8H74.8763L65.9331 172.392L57.3872 134.8Z" fill="#455A64"></path><path d="M66.0094 115.543H54.3757V127.83C54.3757 133.391 59.1163 137.901 64.9588 137.901H67.0729C72.9154 137.901 77.656 133.391 77.656 127.83V115.543H66.0094V115.543ZM107.317 66.8044C107.317 66.8044 114.863 68.1113 114.863 76.2472C114.863 83.4222 109.354 86.2538 103.845 86.2538V66.8044H107.317V66.8044ZM24.9582 66.8044C24.9582 66.8044 17.4116 68.1113 17.4116 76.2472C17.4116 83.4222 22.921 86.2538 28.4304 86.2538V66.8044H24.9582V66.8044Z" fill="#DBA689"></path><path d="M66.1382 13.5428C33.5944 13.5428 25.0869 38.7707 25.0869 74.21C25.0869 110.956 48.7004 120.463 66.1382 120.463C83.3197 120.463 107.189 111.238 107.189 74.21C107.189 38.7707 98.6691 13.5428 66.1382 13.5428V13.5428Z" fill="#FADCBC"></path><path d="M52.6082 77.5028C52.6082 81.1672 50.1611 84.1269 47.1245 84.1269C44.1007 84.1269 41.6279 81.1544 41.6279 77.5028C41.6279 73.8385 44.0879 70.866 47.1245 70.866C50.1611 70.866 52.6082 73.8257 52.6082 77.5028V77.5028ZM79.6426 77.5028C79.6426 81.1672 82.0898 84.1269 85.1392 84.1269C88.1629 84.1269 90.6229 81.1544 90.6229 77.5028C90.6229 73.8385 88.1629 70.866 85.1392 70.866C82.1026 70.866 79.6426 73.8257 79.6426 77.5028Z" fill="#444444"></path><path d="M78.0149 99.8863H54.2605C52.9024 99.8863 52.313 100.796 53.2099 102.18C54.4655 104.102 59.1549 107.792 66.1377 107.792C73.1205 107.792 77.8099 104.102 79.0655 102.18C79.9624 100.796 79.373 99.8863 78.0149 99.8863V99.8863Z" fill="#262626"></path><path d="M71.8779 89.79C69.8536 90.3666 67.7523 90.6356 66.1379 90.6356C64.5236 90.6356 62.4223 90.3538 60.3979 89.79C59.5395 89.5466 59.1936 90.3666 59.5011 90.9047C60.1417 92.0322 62.7298 94.3128 66.1379 94.3128C69.5461 94.3128 72.1342 92.0322 72.7748 90.9047C73.0823 90.3538 72.7364 89.5338 71.8779 89.79V89.79Z" fill="#DBA689"></path><path d="M67.1119 8.91746C67.1119 8.91746 66.4713 8.89184 66.2022 8.90465C65.9331 8.90465 65.2925 8.91746 65.2925 8.91746C30.1735 9.59652 19.5903 30.7243 19.5903 45.369C19.5903 59.6037 19.6031 70.0715 19.6031 70.0715C19.6031 70.0715 20.1669 69.495 21.1919 68.6878C22.2938 67.8293 23.511 67.3553 23.511 67.3553L25.2791 79.2453L36.9769 54.799C37.0538 54.6453 37.2075 54.5556 37.3741 54.5812L44.3056 55.35C51.2756 56.1187 58.2841 56.5031 65.2797 56.5159V56.5287C65.5872 56.5287 65.8819 56.5159 66.1894 56.5159C66.4969 56.5159 66.7916 56.5287 67.0991 56.5287V56.5031C74.0947 56.4775 81.1031 56.1059 88.0731 55.3372L95.0047 54.5684C95.1713 54.5556 95.325 54.6453 95.4019 54.7862L107.1 79.2325L108.868 67.3425C108.868 67.3425 110.085 67.8293 111.187 68.675C112.225 69.4822 112.776 70.0587 112.776 70.0587C112.776 70.0587 112.788 59.6037 112.788 45.3562C112.814 30.7243 102.231 9.59652 67.1119 8.91746V8.91746Z" fill="#312D2D"></path><path d="M52.621 77.7206C52.621 81.3594 50.1866 84.3191 47.1628 84.3191C44.1519 84.3191 41.6919 81.3722 41.6919 77.7206C41.6919 74.0691 44.1391 71.1222 47.1628 71.1222C50.1866 71.1222 52.621 74.0691 52.621 77.7206V77.7206ZM79.5272 77.7206C79.5272 81.3594 81.9616 84.3191 84.9981 84.3191C88.0091 84.3191 90.4563 81.3722 90.4563 77.7206C90.4563 74.0691 88.0091 71.1222 84.9981 71.1222C81.9616 71.1222 79.5272 74.0691 79.5272 77.7206" fill="#262626"></path><path d="M40.2954 146.69L50.302 138.772L38.3735 134.032L54.2354 121.488L65.9332 172.392L40.2954 146.69ZM81.7695 138.618L91.981 146.69L65.9332 172.392L78.041 121.488L93.9029 134.032L81.7695 138.618Z" fill="#E0E0E0"></path><path d="M51.9672 65.5616H36.7844C36.3488 65.5616 35.9131 65.6 35.4903 65.6513C36.4897 65.8178 37.3481 66.356 37.9119 67.0991H51.9544C56.3747 67.0991 59.975 70.4303 59.975 74.5303V81.8206C59.975 85.9206 56.3747 89.2519 51.9544 89.2519H36.7844C32.3641 89.2519 28.7638 85.9206 28.7638 81.8206V75.5553H27.6363C27.4569 75.5553 27.2775 75.5297 27.0981 75.5041V81.8206C27.0981 86.7663 31.4416 90.7894 36.7716 90.7894H51.9544C57.2844 90.7894 61.6278 86.7663 61.6278 81.8206V74.5303C61.6406 69.5847 57.2972 65.5616 51.9672 65.5616Z" fill="#231F20" stroke="#231F20" stroke-width="0.481" stroke-miterlimit="10"></path><path d="M35.4907 65.6512C35.26 65.6128 35.0294 65.5872 34.7988 65.5872H27.6366C25.5354 65.5872 23.8057 67.1759 23.8057 69.1362V72.019C23.8057 73.8 25.2407 75.2734 27.0985 75.5168V74.5431C27.0985 69.9947 30.7629 66.2406 35.4907 65.6512V65.6512Z" fill="black"></path><path d="M28.7646 75.5553V74.5303C28.7646 70.4303 32.3649 67.0991 36.7853 67.0991H37.9256C37.3618 66.3559 36.5034 65.8178 35.504 65.6512C30.7762 66.2406 27.1118 69.9947 27.1118 74.5303V75.5041C27.2912 75.5297 27.4578 75.5553 27.6499 75.5553H28.7646V75.5553Z" fill="black" stroke="black" stroke-width="0.481" stroke-miterlimit="10"></path><path d="M79.6935 65.5616H94.8763C95.3119 65.5616 95.7475 65.6 96.1703 65.6513C95.171 65.8178 94.3125 66.356 93.7488 67.0991H79.6935C75.2731 67.0991 71.6728 70.4303 71.6728 74.5303V81.8206C71.6728 85.9206 75.2731 89.2519 79.6935 89.2519H94.8763C99.2966 89.2519 102.897 85.9206 102.897 81.8206V75.5553H104.024C104.204 75.5553 104.383 75.5297 104.563 75.5041V81.8206C104.563 86.7663 100.219 90.7894 94.8891 90.7894H79.6935C74.3635 90.7894 70.02 86.7663 70.02 81.8206V74.5303C70.02 69.5847 74.3506 65.5616 79.6935 65.5616Z" fill="#231F20" stroke="#231F20" stroke-width="0.481" stroke-miterlimit="10"></path><path d="M96.1709 65.6512C96.4015 65.6128 96.6321 65.5872 96.8628 65.5872H104.025C106.126 65.5872 107.856 67.1759 107.856 69.1362V72.019C107.856 73.8 106.421 75.2734 104.563 75.5168V74.5431C104.55 69.9947 100.899 66.2406 96.1709 65.6512V65.6512Z" fill="black"></path><path d="M102.898 75.5553V74.5303C102.898 70.4303 99.2974 67.0991 94.8771 67.0991H93.7368C94.3006 66.3559 95.159 65.8178 96.1584 65.6512C100.886 66.2406 104.551 69.9947 104.551 74.5303V75.5041C104.371 75.5297 104.205 75.5553 104.012 75.5553H102.898V75.5553Z" fill="black" stroke="black" stroke-width="0.481" stroke-miterlimit="10"></path><path d="M70.9435 75.5553H60.4885L59.0791 68.8287H72.481L70.9435 75.5553Z" fill="#231F20"></path><path d="M135.62 148.817L131.443 148.01L149.829 61.1028H151.43L135.62 148.817Z" fill="#F15A29"></path><path d="M130.264 137.991C132.186 138.465 133.416 139.823 134.275 141.514C136.415 141.13 140.105 140.745 141.181 140.771C142.449 140.809 144.128 140.95 144.409 143.551C144.589 145.242 143.948 146.639 141.783 146.844C140.976 146.921 140.143 146.972 139.323 147.011L139.618 147.959C140.374 147.946 141.053 147.92 141.578 147.92C143.769 147.895 145.012 149.061 145.012 151.38C145.012 153.417 143.256 154.378 141.975 154.455C141.296 154.493 139.4 154.391 137.529 154.211L137.337 154.608L137.26 154.724C138.439 154.903 139.566 155.095 140.361 155.236C142.5 155.621 143.525 157.043 143.282 158.734C142.987 160.784 141.155 161.348 139.887 161.309C138.939 161.284 135.607 160.758 133.378 160.284L132.942 160.912C133.096 160.938 133.263 160.963 133.442 160.989C133.468 160.989 133.493 161.002 133.532 161.002L133.98 161.079C134.019 161.079 134.044 161.092 134.083 161.092C134.262 161.117 134.441 161.156 134.621 161.181H134.646C134.839 161.207 135.031 161.245 135.223 161.284C135.261 161.284 135.3 161.297 135.325 161.297L135.774 161.373C135.838 161.386 135.889 161.399 135.953 161.399C136.081 161.425 136.209 161.45 136.325 161.463L136.517 161.502C136.645 161.527 136.76 161.553 136.876 161.566L137.055 161.604C137.222 161.642 137.401 161.668 137.555 161.707C139.515 162.117 140.258 163.001 140.015 164.551C139.682 166.729 137.491 167.216 136.325 167.101C135.159 166.998 131.238 166.191 129.957 165.627L129.726 165.512L129.278 166.152C123.512 165.768 119.374 163.359 119.374 163.359C115.991 161.463 115.428 160.002 114.864 157.683C114.223 155.044 114.377 151.918 114.403 151.431C114.608 146.178 115.774 142.782 120.014 139.964C121.039 139.285 122.539 138.093 125.857 137.709C127.151 137.581 128.983 137.683 130.264 137.991V137.991Z" fill="#FADCBC"></path><path d="M135.069 146.716C135.069 146.716 135.12 144.077 134.287 141.514L135.21 141.348C135.21 141.348 135.863 143.167 136.094 145.858C136.132 146.293 136.145 146.69 136.145 147.075L136.965 147.023L142.462 146.716C142.462 146.716 142.052 146.793 142.052 147.408C142.052 147.664 142.205 147.831 142.321 147.933C142.09 147.908 141.834 147.882 141.578 147.895L136.12 148.036C136.107 148.189 136.107 148.343 136.094 148.51C135.966 150.739 135.44 152.879 134.198 153.699C138.323 154.186 141.988 154.429 141.988 154.429C141.27 154.724 141.578 155.595 141.578 155.595C138.797 154.839 132.058 154.442 132.058 154.442C129.214 154.198 128.829 156.12 128.829 156.12C128.304 158.439 130.828 159.503 130.828 159.503C131.161 159.695 134.172 160.297 136.325 160.707L138.477 161.104L139.079 161.22C139.015 161.207 138.759 161.194 138.656 161.617C138.605 161.822 138.656 161.963 138.695 162.053C138.375 161.912 137.99 161.783 137.542 161.694C136.53 161.489 133.467 160.989 133.237 160.951L132.468 160.848C129.931 160.515 129.316 160.963 129.316 160.963C127.907 161.707 128.317 163.5 128.317 163.5C128.624 165.23 130.533 165.768 130.533 165.768C131.264 165.986 135.133 166.921 135.133 166.921L129.278 166.153C128.868 166.024 128.714 165.832 128.483 165.653C126.42 163.962 127.292 161.668 127.292 161.668C127.612 160.784 128.278 160.387 128.278 160.387C128.675 160.143 129.137 160.015 129.611 159.964C127.215 158.696 127.599 156.133 127.599 156.133C127.907 154.557 129.047 153.891 129.944 153.609C129.867 153.545 129.777 153.481 129.7 153.404C129.7 153.404 128.163 152.392 128.727 148.048C128.919 146.588 128.893 146.383 128.74 145.46C128.74 145.46 128.189 143.487 126.549 144.115C126.549 144.115 125.998 144.256 125.139 144.935C125.139 144.935 124.447 145.473 124.46 144.628C124.46 144.371 124.64 143.91 124.985 143.513C124.985 143.513 125.344 143.09 126.228 142.847C126.228 142.847 128.522 141.937 129.662 144.23C130.264 145.435 130.149 146.229 129.957 147.459C129.957 147.459 129.598 151.341 130.61 152.584C130.61 152.584 131.61 153.724 133.211 153.02C133.224 153.045 135.402 151.854 135.069 146.716V146.716Z" fill="#DBA689"></path></svg><h5>Profesor</h5>
          </div>
        </div>
        </div>
        </div>
      <div class="form_perfil">
      <div class="col s6 campo_perfil">
        <p class="black-text campos">Nombres:</p>
        <div class="input-field field">
           <i class="material-icons prefix">account_circle</i>
          <input placeholder="Nombre"id="last_name" type="text" class="validate" name="nombre" value="<?php echo $row["nombre"]?>">
        </div>
      </div>
      <div class="col s6 campo_perfil">
        <p class="black-text campos">Apellidos:</p>
        <div class="input-field field">
           <i class="material-icons prefix">account_circle</i>
          <input placeholder="Apellido"id="last_name" type="text" class="validate" name="apellido" value="<?php echo $row["apellido"]?>">
        </div>
        </div>
        <div class="col s6 campo_perfil">
        <p class="black-text campos">Apellidos:</p>
        <div class="input-field field">
          <i class="material-icons prefix">email</i>
          <input id="email" type="email" class="validate" name="correo" value="<?php echo $row["correo"]?>">
        </div>
        </div>
      <div class="col s6 campo_perfil">
      <p class="black-text campos">Cambiar contraseña:</p>
		   <div class="input-field field">
           <i class="material-icons prefix">vpn_key</i>
          <input placeholder="Contraseña" id="password" type="text"class="validate" name="clave" value="<?php echo $row["clave"]?>">
        </div>
        </div>
        <div class="col s6 campo_perfil">
        <p class="black-text campos">Telefono:</p>
         <div class="input-field field">
          <i class="material-icons prefix">phone</i>
          <input id="icon_telephone" type="tel" class="validate" name="telefono" value="<?php echo $row["telefono"]?>">
          </div>
         </div>
        <div class="col s6 campo_perfil">
        <p class="black-text campos">Fecha de nacimiento:</p>
        <div class="input-field field">
           <i class="material-icons prefix">perm_contact_calendar</i>
            <input id="calendario" type="date" name="fechadenac" value="<?php echo $row["fecha de nacimiento"]?>">
          </div>
        </div>
        <div class="col s12">
          <a class="waves-effect waves-light btn-large shake-slow  btninicio"><input type="submit" value="Actualizar los datos" name="modificar"></input></a> 
        </div>      
		    </div>
      </div>
    </div>
  </form>
	</div>
</body>
	<script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
	<script type="text/javascript" src="js/materialize.min.js"></script>
	<script type="text/javascript">
	
$(".dropdown-trigger").dropdown();
	$(document).ready(function(){
    $('.datepicker').datepicker();
  });
      	
		
		</script>
</html>